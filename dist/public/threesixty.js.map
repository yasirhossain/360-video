{"version":3,"sources":["webpack:///webpack/bootstrap 82becfb0353f72ab9713","webpack:///./src/threesixty.js"],"names":["ThreeSixty","THREE","window","document","self","defaults","crossOrigin","clickAndDrag","keyboardControls","fov","fovMin","fovMax","hideControls","lon","lat","loop","debug","flatProjection","autoplay","div","video","Detector","canvas","CanvasRenderingContext2D","webgl","createElement","WebGLRenderingContext","getContext","e","workers","Worker","fileapi","File","FileReader","FileList","Blob","getWebGLErrorMessage","element","id","style","fontFamily","fontSize","fontWeight","textAlign","background","color","padding","width","margin","innerHTML","join","addGetWebGLMessage","parameters","parent","undefined","body","appendChild","attachContainer","options","time","Date","getTime","controls","generateUUID","requestAnimationId","isVideo","isPhoto","isFullscreen","mouseDown","dragStart","originalWidth","querySelectorAll","offsetWidth","originalHeight","offsetHeight","classList","add","className","getAttribute","setAttribute","attachVideo","createMediaPlayer","createControls","d","uuid","replace","c","r","Math","random","floor","toString","scene","Scene","camera","PerspectiveCamera","setLens","renderer","WebGLRenderer","CanvasRenderer","setSize","autoClear","setClearColor","domElement","createAnimation","texture","generateMipmaps","minFilter","LinearFilter","magFilter","format","RGBFormat","mesh","Mesh","SphereGeometry","MeshBasicMaterial","map","scale","x","animate","ImageUtils","loadTexture","isIE","loadingElem","showWaiting","display","addEventListener","percent","buffered","length","end","duration","bytesTotal","bufferedBytes","cpct","round","event","console","error","showError","paused","currentTime","children","durMin","durSec","timeMin","timeSec","navigator","appName","userAgent","match","videocanvas","Texture","videoWidth","height","videoHeight","xhr","XMLHttpRequest","open","responseType","onload","srcElement","status","vid","URL","createObjectURL","response","hideWaiting","play","videoReady","src","onreadystatechange","oEvent","readyState","send","log","playPauseControl","controlsElem","attachControlEvents","onMouseMove","bind","onMouseWheel","onMouseDown","onMouseUp","onKeyDown","onKeyUp","onKeyArrowPress","focus","onresize","resizeGL","onPointerDownPointerX","clientX","onPointerDownPointerY","clientY","rect","getBoundingClientRect","relativeX","pageX","left","onPointerDownLon","onPointerDownLat","y","pageY","top","wheelSpeed","wheelDeltaY","wheelDelta","detail","preventDefault","onProgressClick","HAVE_ENOUGH_DATA","keyCode","keydown","pressEvent","createEvent","initCustomEvent","dispatchEvent","offset","pressDelay","setTimeout","requestAnimationFrame","drawImage","ct","needsUpdate","render","max","min","phi","PI","theta","cx","sin","cos","cy","cz","lookAt","Vector3","position","z","clear","pause","loadVideo","videoFile","unloadVideo","loadPhoto","photoFile","w","h","aspect","updateProjectionMatrix","loading","destroy","cancelAnimationFrame","dispose","parentNode","removeChild","module","exports"],"mappings":"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","file":"threesixty.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/public/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 82becfb0353f72ab9713\n **/","// TODO strip out options\n// TODO see if you can remove need for window / document by using attach to pass elements only\n\nconst ThreeSixty = (THREE, window, document) => {\n  let self = {},\n      defaults = {\n        crossOrigin: 'anonymous',\n        clickAndDrag: false,\n\t      keyboardControls: true,\n        fov: 35,\n        fovMin: 3,\n        fovMax: 100,\n        hideControls: false,\n        lon: 0,\n        lat: 0,\n        loop: \"loop\",\n        debug: false,\n        flatProjection: false,\n        autoplay: true\n      },\n      div,\n      video\n\n    const Detector = {\n      canvas: !! window.CanvasRenderingContext2D,\n      webgl: ( function () { try { var canvas = document.createElement( 'canvas' ); return !! window.WebGLRenderingContext && ( canvas.getContext( 'webgl' ) || canvas.getContext( 'experimental-webgl' ) ); } catch( e ) { return false; } } )(),\n      workers: !! window.Worker,\n      fileapi: window.File && window.FileReader && window.FileList && window.Blob,\n      getWebGLErrorMessage: () => {\n        let element = document.createElement('div')\n        element.id = 'webgl-error-message'\n        element.style.fontFamily = 'monospace'\n        element.style.fontSize = '13px'\n        element.style.fontWeight = 'normal'\n        element.style.textAlign = 'center'\n        element.style.background = '#fff'\n        element.style.color = '#000'\n        element.style.padding = '1.5em'\n        element.style.width = '800px'\n        element.style.margin = '5em auto 0'\n        if (!self.webgl) {\n          element.innerHTML = window.WebGLRenderingContext ? [\n            'Your graphics card does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000\">WebGL</a>.<br />',\n            'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000\">here</a>.'\n          ].join( '\\n' ) : [\n            'Your browser does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000\">WebGL</a>.<br/>',\n            'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000\">here</a>.'\n          ].join( '\\n' );\n        }\n\n        return element;\n      },\n      addGetWebGLMessage: (parameters) => {\n        let parent, id, element\n\n        parameters = parameters || {}\n\n        parent = parameters.parent !== undefined ? parameters.parent : document.body\n        id = parameters.id !== undefined ? parameters.id : 'oldie'\n\n        element = Detector.getWebGLErrorMessage()\n        element.id = id\n\n        parent.appendChild(element)\n      }\n    }\n\n  const attachContainer = (element) => {\n    self.element = element\n    self.options = defaults\n\n    // instantiate some local variables we're going to need\n    self.time = new Date().getTime()\n    self.controls = {}\n    self.id = generateUUID()\n\n    self.requestAnimationId = '' // used to cancel requestAnimationFrame on destroy\n    self.isVideo = false\n    self.isPhoto = false\n    self.isFullscreen = false\n    self.mouseDown = false\n    self.dragStart = {}\n\n    self.lat = self.options.lat;\n    self.lon = self.options.lon;\n    self.fov = self.options.fov;\n\n    // save our original height and width for returning from fullscreen\n    self.originalWidth = self.element.querySelectorAll('canvas').offsetWidth\n    self.originalHeight = self.element.querySelectorAll('canvas').offsetHeight\n\n    // add a class to our element so it inherits the appropriate styles\n    if (self.element.classList)\n      self.element.classList.add('default')\n    else\n      self.element.className += ' ' + 'default'\n\n    // add tabindex attribute to enable the focus on the element (required for keyboard controls)\n    if(self.options.keyboardControls && !self.element.getAttribute(\"tabindex\")) {\n      self.element.setAttribute(\"tabindex\", \"1\")\n    }\n  }\n\n  const attachVideo = (element) => {\n    video = element\n    createMediaPlayer()\n    createControls()\n  }\n\n  const generateUUID = () => {\n    let d = new Date().getTime(),\n        uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n          let r = (d + Math.random()*16)%16 | 0\n          d = Math.floor(d/16);\n          return (c==='x' ? r : (r&0x7|0x8)).toString(16);\n        })\n    return uuid\n  }\n\n  const createMediaPlayer = () => {\n    // make a self reference we can pass to our callbacks\n    // create a local THREE.js scene\n    self.scene = new THREE.Scene()\n\n    // create ThreeJS camera\n    self.camera = new THREE.PerspectiveCamera(self.fov, self.element.offsetWidth / self.element.offsetHeight, 0.1, 1000)\n    self.camera.setLens(self.fov)\n\n    // create ThreeJS renderer and append it to our object\n    self.renderer = Detector.webgl? new THREE.WebGLRenderer(): new THREE.CanvasRenderer()\n    self.renderer.setSize(self.element.offsetWidth, self.element.offsetHeight)\n    self.renderer.autoClear = false\n    self.renderer.setClearColor(0x333333, 1)\n\n    // append the rendering element to self div\n    self.element.appendChild(self.renderer.domElement)\n\n    const createAnimation = () => {\n      self.texture.generateMipmaps = false\n      self.texture.minFilter = THREE.LinearFilter\n      self.texture.magFilter = THREE.LinearFilter\n      self.texture.format = THREE.RGBFormat\n\n      // create ThreeJS mesh sphere onto which our texture will be drawn\n      self.mesh = new THREE.Mesh(new THREE.SphereGeometry( 500, 80, 50 ), new THREE.MeshBasicMaterial({map: self.texture}))\n      self.mesh.scale.x = -1 // mirror the texture, since we're looking from the inside out\n      self.scene.add(self.mesh)\n\n      animate()\n    }\n\n    // figure out our texturing situation, based on what our source is\n    if(self.element.getAttribute('data-photo-src')) {\n      self.isPhoto = true\n      THREE.ImageUtils.crossOrigin = self.options.crossOrigin\n      self.texture = THREE.ImageUtils.loadTexture(self.element.getAttribute('data-photo-src'))\n      createAnimation()\n    } else {\n      if (video) {\n        // create loading overlay\n        let loadingElem = document.createElement('div')\n        if (loadingElem.classList)\n          loadingElem.classList.add('loading');\n        else\n          loadingElem.className += ' ' + 'loading'\n\n        loadingElem.innerHTML = `\n          <div class=\"icon waiting-icon\"></div>\n          <div class=\"icon error-icon\"><i class=\"fa fa-exclamation-triangle\" aria-hidden=\"true\"></i></div>\n        `\n        self.element.appendChild(loadingElem)\n        showWaiting()\n\n        self.isVideo = true\n\n        self.video = video\n        self.video.setAttribute('crossorigin', self.options.crossOrigin)\n        self.video.style.display = 'none'\n        self.video.loop = self.options.loop\n\n        // attach video player event listeners\n        self.video.addEventListener(\"ended\", () => {})\n\n        // Progress Meter\n        self.video.addEventListener(\"progress\", () => {\n          let percent = null\n          if (self.video && self.video.buffered && self.video.buffered.length > 0 && self.video.buffered.end && self.video.duration) {\n            percent = self.video.buffered.end(0) / self.video.duration\n          }\n          // Some browsers (e.g., FF3.6 and Safari 5) cannot calculate target.bufferered.end()\n          // to be anything other than 0. If the byte count is available we use self instead.\n          // Browsers that support the else if do not seem to have the bufferedBytes value and\n          // should skip to there. Tested in Safari 5, Webkit head, FF3.6, Chrome 6, IE 7/8.\n          else if (self.video && self.video.bytesTotal !== undefined && self.video.bytesTotal > 0 && self.video.bufferedBytes !== undefined) {\n            percent = self.video.bufferedBytes / self.video.bytesTotal\n          }\n\n          // Someday we can have a loading animation for videos\n          var cpct = Math.round(percent * 100)\n          if(cpct === 100) {\n            // do something now that we are done\n          } else {\n            // do something with self percentage info (cpct)\n          }\n        })\n\n        // Error listener\n        self.video.addEventListener('error', (event) => {\n          console.error(self.video.error)\n          showError()\n        })\n\n        self.video.addEventListener(\"timeupdate\", () => {\n          if (self.paused === false){\n            let percent = self.currentTime * 100 / self.duration\n            self.element.querySelectorAll('.controlsWrapper > .progress-bar')[0].children[0].setAttribute(\"style\", \"width:\" + percent + \"%;\")\n            self.element.querySelectorAll('.controlsWrapper > .progress-bar')[0].children[1].setAttribute(\"style\", \"width:\" + (100 - percent) + \"%;\")\n            //Update time label\n            let durMin = Math.floor(self.duration / 60),\n                durSec = Math.floor(self.duration - (durMin * 60)),\n                timeMin = Math.floor(self.currentTime / 60),\n                timeSec = Math.floor(self.currentTime - (timeMin * 60)),\n                duration = durMin + ':' + (durSec < 10 ? '0' + durSec : durSec),\n                currentTime = timeMin + ':' + (timeSec < 10 ? '0' + timeSec : timeSec)\n            self.element.querySelectorAll('.controls .timeLabel').innerHTML = (currentTime + ' / ' + duration)\n          }\n        })\n\n        // IE 11 and previous not supports THREE.Texture([video]), we must create a canvas that draws the video and use that to create the Texture\n        var isIE = navigator.appName == 'Microsoft Internet Explorer' || !!(navigator.userAgent.match(/Trident/) || navigator.userAgent.match(/rv 11/))\n        if (isIE) {\n          self.videocanvas = document.createElement('canvas')\n          self.texture = new THREE.Texture(self.videocanvas)\n          // set canvas size = video size when known\n          self.video.addEventListener('loadedmetadata', () => {\n            self.videocanvas.width = self.video.videoWidth;\n            self.videocanvas.height = self.video.videoHeight;\n            createAnimation()\n          })\n        } else {\n          self.texture = new THREE.Texture( self.video )\n        }\n\n        //force browser caching of the video to solve rendering errors with big videos\n        let xhr = new XMLHttpRequest()\n        xhr.open('GET', self.video.getAttribute('src'), true)\n        xhr.responseType = 'blob'\n        xhr.onload = function (e) {\n          if (e.srcElement.status === 200) {\n            let vid = URL.createObjectURL(e.srcElement.response)\n            //Video Play Listener, fires after video loads\n            self.video.addEventListener(\"canplaythrough\", () => {\n              if (self.options.autoplay === true) {\n                hideWaiting()\n                play()\n                self.videoReady = true\n              }\n            })\n\n            // set the video src and begin loading\n            self.video.src = vid\n          }\n        };\n\n        xhr.onreadystatechange = (oEvent) => {\n          if (xhr.readyState === 4) {\n            if (xhr.status !== 200) {\n              console.error('Video error: status ' + xhr.status)\n              showError()\n            }\n          }\n        }\n        xhr.send()\n\n        if(!isIE) createAnimation()\n      } else {\n        console.log(`Please add a video`)\n      }\n    }\n  }\n\n  const createControls = () => {\n    let playPauseControl = self.options.autoplay ? 'fa-pause' : 'fa-play',\n        controlsElem = document.createElement('div')\n\n    if (controlsElem.classList)\n      controlsElem.classList.add('controlsWrapper')\n    else\n      controlsElem.className += ' ' + 'controlsWrapper'\n\n    controlsElem.innerHTML = `\n      <div class=\"progress-bar\">\n        <div style=\"width: 0;\"></div><div style=\"width: 100%;\"></div>\n      </div>\n      <div class=\"controls\">\n        <a href=\"#\" class=\"playButton button fa '+ playPauseControl +'\"></a>\n        <span class=\"timeLabel\"></span>\n        <a href=\"#\" class=\"fullscreenButton button fa fa-expand\"></a>\n      </div>`\n\n    self.element.appendChild(controlsElem)\n\n    // hide controls if option is set\n    if(self.options.hideControls) {\n      self.element.querySelectorAll('.controls').style.display = 'none'\n    }\n\n    // wire up controller events to dom elements\n    attachControlEvents()\n  }\n\n  const attachControlEvents = () => {\n    self.element.addEventListener( 'mousemove', onMouseMove.bind(self), false )\n    self.element.addEventListener( 'touchmove', onMouseMove.bind(self), false )\n    self.element.addEventListener( 'mousewheel', onMouseWheel.bind(self), false )\n    self.element.addEventListener( 'DOMMouseScroll', onMouseWheel.bind(self), false )\n    self.element.addEventListener( 'mousedown', onMouseDown.bind(self), false)\n    self.element.addEventListener( 'touchstart', onMouseDown.bind(self), false)\n    self.element.addEventListener( 'mouseup', onMouseUp.bind(self), false)\n    self.element.addEventListener( 'touchend', onMouseUp.bind(self), false)\n\n    if(self.options.keyboardControls) {\n      self.element.addEventListener('keydown', onKeyDown.bind(self), false)\n      self.element.addEventListener('keyup', onKeyUp.bind(self), false)\n      // Used custom press event because for the arrow buttons is not throws the 'keypress' event\n      self.element.addEventListener('keyArrowPress', onKeyArrowPress.bind(self), false)\n      self.element.addEventListener('click', () => {\n        self.element.focus()\n      },false)\n    }\n\n    window.onresize = () => {\n      resizeGL(self.element.offsetWidth, self.element.offsetHeight)\n    }\n  }\n\n  const onMouseMove = (event) => {\n    self.onPointerDownPointerX = event.clientX\n    self.onPointerDownPointerY = -event.clientY\n\n    let rect = self.element.querySelectorAll('canvas')[0].getBoundingClientRect()\n    self.relativeX = event.pageX - rect.left\n\n    self.onPointerDownLon = self.lon\n    self.onPointerDownLat = self.lat\n\n    let x, y\n\n    if(self.options.clickAndDrag) {\n      if(self.mouseDown) {\n        x = event.pageX - self.dragStart.x\n        y = event.pageY - self.dragStart.y\n        self.dragStart.x = event.pageX\n        self.dragStart.y = event.pageY\n        self.lon += x\n        self.lat -= y\n      }\n    } else {\n      x = event.pageX - rect.left\n      y = event.pageY - rect.top\n\n      self.lon = ( x / self.element.querySelectorAll('canvas')[0].offsetWidth ) * 430 - 225\n      self.lat = ( y / self.element.querySelectorAll('canvas')[0].offsetHeight ) * -180 + 90\n    }\n  }\n\n  const onMouseWheel = (event) => {\n    let wheelSpeed = -0.01\n\n    // WebKit\n    if (event.wheelDeltaY) {\n      self.fov -= event.wheelDeltaY * wheelSpeed\n    // Opera / Explorer 9\n    } else if (event.wheelDelta) {\n      self.fov -= event.wheelDelta * wheelSpeed\n    // Firefox\n    } else if (event.detail) {\n      self.fov += event.detail * 1.0\n    }\n\n    if(self.fov < self.options.fovMin) {\n      self.fov = self.options.fovMin\n    } else if(self.fov > self.options.fovMax) {\n      self.fov = self.options.fovMax\n    }\n\n    self.camera.setLens(self.fov)\n    event.preventDefault()\n  }\n\n  const onMouseDown = (event) => {\n    self.mouseDown = true\n    self.dragStart.x = event.pageX\n    self.dragStart.y = event.pageY\n  }\n\n  const onProgressClick = (event) => {\n    if(self.isVideo && self.video.readyState === self.video.HAVE_ENOUGH_DATA) {\n      let percent =  self.relativeX / self.element.querySelectorAll('canvas').offsetWidth * 100\n      self.element.querySelectorAll('.controlsWrapper > .progress-bar')[0].children[0].setAttribute(\"style\", \"width:\" + percent + \"%;\")\n      self.element.querySelectorAll('.controlsWrapper > .progress-bar')[0].children[1].setAttribute(\"style\", \"width:\" + (100 - percent) + \"%;\")\n      self.video.currentTime = self.video.duration * percent / 100\n    }\n  }\n\n  const onMouseUp = (event) => {\n    self.mouseDown = false\n  }\n\n  const onKeyDown = (event) => {\n   let keyCode = event.keyCode\n   if (keyCode >= 37 && keyCode <= 40) {\n     event.preventDefault()\n     self.keydown = true\n     let pressEvent = document.createEvent('CustomEvent')\n     pressEvent.initCustomEvent(\"keyArrowPress\",true,true,{'keyCode':keyCode})\n     self.element.dispatchEvent(pressEvent)\n   }\n  }\n\n  const onKeyUp = (event) => {\n   let keyCode = event.keyCode;\n   if (keyCode >= 37 && keyCode <= 40) {\n     event.preventDefault()\n     self.keydown = false\n   }\n  }\n\n  const onKeyArrowPress = (event) => {\n   if (self.keydown) {\n     let keyCode = event.detail? event.detail.keyCode:null,\n         offset = 3,\n         pressDelay = 50,\n         element = self.element\n\n     event.preventDefault()\n     switch (keyCode) {\n       //Arrow left\n       case 37: self.lon -= offset;\n         break;\n       //Arrow right\n       case 39: self.lon += offset;\n         break;\n       //Arrow up\n       case 38: self.lat += offset;\n         break;\n       //Arrow down\n       case 40: self.lat -= offset;\n         break;\n     }\n     setTimeout(() => {\n       let pressEvent = document.createEvent('CustomEvent')\n       pressEvent.initCustomEvent(\"keyArrowPress\",true,true,{'keyCode':keyCode})\n       element.dispatchEvent(pressEvent)\n     },\n     pressDelay)\n   }\n  }\n\n  const animate = () => {\n    // set our animate function to fire next time a frame is ready\n    self.requestAnimationId = requestAnimationFrame(animate.bind(self))\n\n    if(self.isVideo) {\n      if ( self.video.readyState === self.video.HAVE_ENOUGH_DATA) {\n        if(self.videocanvas) {\n          self.videocanvas.getContext('2d').drawImage(self.video, 0, 0, self.videocanvas.width, self.videocanvas.height)\n        }\n        if(typeof(self.texture) !== \"undefined\" ) {\n          let ct = new Date().getTime()\n          if(ct - self.time >= 30) {\n            self.texture.needsUpdate = true\n            self.time = ct\n          }\n        }\n      }\n    }\n    render()\n  }\n\n  const render = () => {\n    self.lat = Math.max( - 85, Math.min( 85, self.lat))\n    self.phi = ( 90 - self.lat ) * Math.PI / 180\n    self.theta = self.lon * Math.PI / 180\n\n    let cx = 500 * Math.sin( self.phi ) * Math.cos( self.theta ),\n        cy = 500 * Math.cos( self.phi ),\n        cz = 500 * Math.sin( self.phi ) * Math.sin( self.theta )\n\n    self.camera.lookAt(new THREE.Vector3(cx, cy, cz))\n\n    // distortion\n    if(self.options.flatProjection) {\n      self.camera.position.x = 0\n      self.camera.position.y = 0\n      self.camera.position.z = 0\n    } else {\n      self.camera.position.x = - cx\n      self.camera.position.y = - cy\n      self.camera.position.z = - cz\n    }\n\n    self.renderer.clear()\n    self.renderer.render( self.scene, self.camera )\n  }\n\n  const play = () => {\n    //code to play media\n    self.video.play()\n  }\n\n  const pause = () => {\n    //code to stop media\n    self.video.pause()\n  }\n\n  const loadVideo = (videoFile) => {\n    self.video.src = videoFile\n  }\n\n  const unloadVideo = () => {\n    // overkill unloading to avoid dreaded video 'pending' bug in Chrome. See https://code.google.com/p/chromium/issues/detail?id=234779\n    self.pause()\n    self.video.src = ''\n    self.video.setAttribute('src', '')\n  }\n\n  const loadPhoto = (photoFile) => {\n    self.texture = THREE.ImageUtils.loadTexture( photoFile );\n  }\n\n  const resizeGL = (w, h) => {\n    self.renderer.setSize(w, h)\n    self.camera.aspect = w / h\n    self.camera.updateProjectionMatrix()\n  }\n\n  const showWaiting = () => {\n    let loading = self.element.querySelectorAll('.loading')[0]\n    loading.querySelectorAll('.waiting-icon')[0].style.display = ''\n    loading.querySelectorAll('.error-icon')[0].style.display = 'none'\n    loading.style.display = ''\n  }\n\n  const hideWaiting = () => {\n    self.element.querySelectorAll('.loading')[0].style.display = 'none'\n  }\n\n  const showError = () => {\n    let loading = self.element.querySelectorAll('.loading')[0]\n    loading.querySelectorAll('.waiting-icon')[0].style.display = 'none'\n    loading.querySelectorAll('.error-icon').style.display = ''\n    loading.style.display = ''\n  }\n\n  const destroy = () => {\n    window.cancelAnimationFrame(self.requestAnimationId)\n    self.requestAnimationId = ''\n    self.texture.dispose()\n    self.scene.parentNode.removeChild(self.mesh)\n    if (self.isVideo) {\n      unloadVideo()\n    }\n    self.renderer.parentNode.removeChild()\n  }\n\n  return {\n    attachContainer,\n    attachVideo\n  }\n}\n\nmodule.exports = ThreeSixty\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/threesixty.js\n **/"],"sourceRoot":""}